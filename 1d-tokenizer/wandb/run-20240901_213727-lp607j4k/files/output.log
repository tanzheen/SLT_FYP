[32m[09/01 21:37:27 TiTok]: [39mSaving config to titok_b_64_stage1_run1\config.yaml
[32m[09/01 21:37:27 TiTok]: [39mConfig:
experiment:
  project: titok_b_64_stage1
  name: titok_b_64_stage1_run1
  output_dir: titok_b_64_stage1_run1
  max_train_examples: 1281167
  save_every: 50000
  eval_every: 50000
  generate_every: 5000
  log_every: 200
  log_grad_norm_every: 4000
  resume: true
  init_weight: ''
  logging_dir: titok_b_64_stage1_run1\logs
model:
  vq_model:
    codebook_size: 4096
    token_size: 12
    use_l2_norm: true
    commitment_cost: 0.25
    vit_enc_model_size: base
    vit_dec_model_size: base
    vit_enc_patch_size: 16
    vit_dec_patch_size: 16
    num_latent_tokens: 64
    finetune_decoder: false
    pretrained_tokenizer_weight: maskgit-vqgan-imagenet-f16-256.bin
losses:
  quantizer_weight: 1.0
dataset:
  params:
    params: null
    img_path: ../../CSL-Daily/sentence/frames_512x512/
    num_workers: 10
  preprocessing:
    resize_shorter_edge: 256
    crop_size: 256
    random_crop: true
    random_flip: true
optimizer:
  name: adamw
  params:
    learning_rate: 0.0001
    beta1: 0.9
    beta2: 0.99
    weight_decay: 0.0001
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 10000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 64
  mixed_precision: fp16
  enable_tf32: true
  enable_wandb: true
  use_ema: true
  seed: 42
  max_train_steps: 500000
  num_generated_images: 2
  max_grad_norm: 1.0
config: configs/training/stage1/titok_b64_CSL.yaml
--experiment:
  project: titok_b64_CSL_stage1
  name: titok_b64_CSL_stage1_run1
  output_dir: titok_b64_CSL_stage1_run1
--training:
  per_gpu_batch_size: 32
[32m[09/01 21:37:28 TiTok]: [39mCreating model and loss module.
===================================================================================================================================================================================================
Layer (type:depth-idx)                        Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
===================================================================================================================================================================================================
TiTok                                         [1, 3, 256, 256]          [1, 1024, 16, 16]         49,152                      0.03%                   --                        --
├─TiTokEncoder: 1-1                           --                        [1, 12, 1, 64]            247,296                     0.14%                   --                        --
│    └─Conv2d: 2-1                            [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.34%                   [16, 16]                  151,191,552
│    └─LayerNorm: 2-2                         [1, 321, 768]             [1, 321, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-3                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-1       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-1               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-2      [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-3               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-4              [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-1             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-2               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-3             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-2       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-5               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-6      [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-7               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-8              [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-4             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-5               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-6             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-3       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-9               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-10     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-11              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-12             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-7             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-8               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-9             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-4       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-13              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-14     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-15              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-16             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-10            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-11              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-12            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-5       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-17              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-18     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-19              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-20             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-13            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-14              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-15            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-6       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-21              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-22     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-23              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-24             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-16            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-17              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-18            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-7       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-25              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-26     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-27              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-28             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-19            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-20              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-21            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-8       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-29              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-30     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-31              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-32             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-22            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-23              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-24            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-9       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-33              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-34     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-35              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-36             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-25            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-26              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-27            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-10      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-37              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-38     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-39              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-40             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-28            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-29              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-30            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-11      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-41              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-42     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-43              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-44             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-31            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-32              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-33            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-12      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-45              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-46     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-47              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-48             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-34            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-35              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-36            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    └─LayerNorm: 2-4                         [1, 64, 768]              [1, 64, 768]              1,536                       0.00%                   --                        1,536
│    └─Conv2d: 2-5                            [1, 768, 64, 1]           [1, 12, 64, 1]            9,228                       0.01%                   [1, 1]                    590,592
├─VectorQuantizer: 1-2                        [1, 12, 1, 64]            [1, 12, 1, 64]            --                             --                   --                        --
│    └─Embedding: 2-6                         [64]                      [64, 12]                  49,152                      0.03%                   --                        3,145,728
├─TiTokDecoder: 1-3                           [1, 12, 1, 64]            [1, 1024, 16, 16]         248,064                     0.14%                   --                        --
│    └─Linear: 2-7                            [1, 64, 12]               [1, 64, 768]              9,984                       0.01%                   --                        9,984
│    └─LayerNorm: 2-8                         [1, 321, 768]             [1, 321, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-9                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-13      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-49              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-50     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-51              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-52             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-37            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-38              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-39            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-14      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-53              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-54     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-55              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-56             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-40            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-41              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-42            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-15      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-57              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-58     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-59              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-60             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-43            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-44              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-45            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-16      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-61              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-62     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-63              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-64             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-46            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-47              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-48            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-17      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-65              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-66     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-67              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-68             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-49            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-50              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-51            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-18      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-69              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-70     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-71              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-72             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-52            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-53              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-54            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-19      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-73              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-74     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-75              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-76             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-55            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-56              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-57            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-20      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-77              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-78     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-79              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-80             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-58            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-59              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-60            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-21      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-81              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-82     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-83              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-84             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-61            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-62              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-63            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-22      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-85              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-86     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-87              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-88             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-64            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-65              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-66            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-23      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-89              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-90     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-91              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-92             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-67            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-68              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-69            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-24      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-93              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-94     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-95              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-96             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-70            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-71              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-72            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    └─LayerNorm: 2-10                        [1, 256, 768]             [1, 256, 768]             1,536                       0.00%                   --                        1,536
│    └─Sequential: 2-11                       [1, 768, 16, 16]          [1, 1024, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-25                      [1, 768, 16, 16]          [1, 1536, 16, 16]         1,181,184                   0.68%                   [1, 1]                    302,383,104
│    │    └─Tanh: 3-26                        [1, 1536, 16, 16]         [1, 1536, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-27                      [1, 1536, 16, 16]         [1, 1024, 16, 16]         1,573,888                   0.90%                   [1, 1]                    402,915,328
│    └─Identity: 2-12                         [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
===================================================================================================================================================================================================
Total params: 174,073,612
Trainable params: 174,073,612
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 37.27
===================================================================================================================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 344.47
Params size (MB): 467.33
Estimated Total Size (MB): 812.58
===================================================================================================================================================================================================
[32m[09/01 21:37:28 TiTok]: [39m===================================================================================================================================================================================================
Layer (type:depth-idx)                        Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
===================================================================================================================================================================================================
TiTok                                         [1, 3, 256, 256]          [1, 1024, 16, 16]         49,152                      0.03%                   --                        --
├─TiTokEncoder: 1-1                           --                        [1, 12, 1, 64]            247,296                     0.14%                   --                        --
│    └─Conv2d: 2-1                            [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.34%                   [16, 16]                  151,191,552
│    └─LayerNorm: 2-2                         [1, 321, 768]             [1, 321, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-3                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-1       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-1               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-2      [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-3               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-4              [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-1             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-2               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-3             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-2       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-5               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-6      [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-7               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-8              [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-4             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-5               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-6             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-3       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-9               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-10     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-11              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-12             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-7             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-8               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-9             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-4       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-13              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-14     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-15              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-16             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-10            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-11              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-12            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-5       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-17              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-18     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-19              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-20             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-13            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-14              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-15            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-6       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-21              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-22     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-23              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-24             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-16            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-17              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-18            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-7       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-25              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-26     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-27              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-28             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-19            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-20              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-21            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-8       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-29              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-30     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-31              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-32             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-22            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-23              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-24            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-9       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-33              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-34     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-35              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-36             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-25            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-26              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-27            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-10      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-37              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-38     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-39              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-40             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-28            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-29              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-30            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-11      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-41              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-42     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-43              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-44             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-31            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-32              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-33            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-12      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-45              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-46     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-47              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-48             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-34            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-35              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-36            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    └─LayerNorm: 2-4                         [1, 64, 768]              [1, 64, 768]              1,536                       0.00%                   --                        1,536
│    └─Conv2d: 2-5                            [1, 768, 64, 1]           [1, 12, 64, 1]            9,228                       0.01%                   [1, 1]                    590,592
├─VectorQuantizer: 1-2                        [1, 12, 1, 64]            [1, 12, 1, 64]            --                             --                   --                        --
│    └─Embedding: 2-6                         [64]                      [64, 12]                  49,152                      0.03%                   --                        3,145,728
├─TiTokDecoder: 1-3                           [1, 12, 1, 64]            [1, 1024, 16, 16]         248,064                     0.14%                   --                        --
│    └─Linear: 2-7                            [1, 64, 12]               [1, 64, 768]              9,984                       0.01%                   --                        9,984
│    └─LayerNorm: 2-8                         [1, 321, 768]             [1, 321, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-9                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-13      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-49              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-50     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-51              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-52             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-37            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-38              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-39            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-14      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-53              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-54     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-55              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-56             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-40            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-41              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-42            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-15      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-57              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-58     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-59              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-60             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-43            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-44              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-45            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-16      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-61              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-62     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-63              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-64             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-46            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-47              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-48            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-17      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-65              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-66     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-67              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-68             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-49            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-50              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-51            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-18      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-69              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-70     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-71              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-72             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-52            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-53              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-54            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-19      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-73              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-74     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-75              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-76             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-55            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-56              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-57            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-20      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-77              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-78     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-79              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-80             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-58            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-59              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-60            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-21      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-81              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-82     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-83              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-84             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-61            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-62              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-63            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-22      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-85              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-86     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-87              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-88             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-64            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-65              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-66            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-23      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-89              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-90     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-91              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-92             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-67            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-68              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-69            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-24      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-93              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-94     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-95              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-96             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-70            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-71              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-72            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    └─LayerNorm: 2-10                        [1, 256, 768]             [1, 256, 768]             1,536                       0.00%                   --                        1,536
│    └─Sequential: 2-11                       [1, 768, 16, 16]          [1, 1024, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-25                      [1, 768, 16, 16]          [1, 1536, 16, 16]         1,181,184                   0.68%                   [1, 1]                    302,383,104
│    │    └─Tanh: 3-26                        [1, 1536, 16, 16]         [1, 1536, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-27                      [1, 1536, 16, 16]         [1, 1024, 16, 16]         1,573,888                   0.90%                   [1, 1]                    402,915,328
│    └─Identity: 2-12                         [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
===================================================================================================================================================================================================
Total params: 174,073,612
Trainable params: 174,073,612
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 37.27
===================================================================================================================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 344.47
Params size (MB): 467.33
Estimated Total Size (MB): 812.58
===================================================================================================================================================================================================
[32m[09/01 21:37:28 TiTok]: [39mCreating optimizers.
[32m[09/01 21:37:28 TiTok]: [39mCreating lr_schedulers.
[32m[09/01 21:37:28 TiTok]: [39mCreating dataloaders. Batch size = 64
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\nn\functional.py:5504: UserWarning: 1Torch was not compiled with flash attention. (Triggered internally at ..\aten\src\ATen\native\transformers\cuda\sdp_utils.cpp:455.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode characters in position 794-795: character maps to <undefined>
Call stack:
  File "E:\SLT_FYP\1d-tokenizer\scripts\train_titok.py", line 181, in <module>
    main()
  File "E:\SLT_FYP\1d-tokenizer\scripts\train_titok.py", line 90, in main
    model, ema_model, loss_module = create_model_and_loss_module(
  File "E:\SLT_FYP\1d-tokenizer\utils\train_utils.py", line 144, in create_model_and_loss_module
    logger.info(model_summary_str)
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1849, in info
    self.log(INFO, msg, *args, **kwargs)
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\accelerate\logging.py", line 63, in log
    self.logger.log(level, msg, *args, **kwargs)
Message: ===================================================================================================================================================================================================
Layer (type:depth-idx)                        Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
===================================================================================================================================================================================================
TiTok                                         [1, 3, 256, 256]          [1, 1024, 16, 16]         49,152                      0.03%                   --                        --
├─TiTokEncoder: 1-1                           --                        [1, 12, 1, 64]            247,296                     0.14%                   --                        --
│    └─Conv2d: 2-1                            [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.34%                   [16, 16]                  151,191,552
│    └─LayerNorm: 2-2                         [1, 321, 768]             [1, 321, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-3                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-1       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-1               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-2      [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-3               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-4              [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-1             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-2               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-3             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-2       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-5               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-6      [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-7               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-8              [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-4             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-5               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-6             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-3       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-9               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-10     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-11              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-12             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-7             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-8               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-9             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-4       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-13              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-14     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-15              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-16             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-10            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-11              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-12            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-5       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-17              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-18     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-19              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-20             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-13            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-14              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-15            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-6       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-21              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-22     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-23              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-24             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-16            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-17              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-18            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-7       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-25              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-26     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-27              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-28             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-19            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-20              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-21            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-8       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-29              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-30     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-31              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-32             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-22            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-23              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-24            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-9       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-33              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-34     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-35              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-36             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-25            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-26              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-27            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-10      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-37              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-38     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-39              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-40             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-28            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-29              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-30            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-11      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-41              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-42     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-43              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-44             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-31            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-32              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-33            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-12      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-45              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-46     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-47              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-48             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-34            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-35              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-36            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    └─LayerNorm: 2-4                         [1, 64, 768]              [1, 64, 768]              1,536                       0.00%                   --                        1,536
│    └─Conv2d: 2-5                            [1, 768, 64, 1]           [1, 12, 64, 1]            9,228                       0.01%                   [1, 1]                    590,592
├─VectorQuantizer: 1-2                        [1, 12, 1, 64]            [1, 12, 1, 64]            --                             --                   --                        --
│    └─Embedding: 2-6                         [64]                      [64, 12]                  49,152                      0.03%                   --                        3,145,728
├─TiTokDecoder: 1-3                           [1, 12, 1, 64]            [1, 1024, 16, 16]         248,064                     0.14%                   --                        --
│    └─Linear: 2-7                            [1, 64, 12]               [1, 64, 768]              9,984                       0.01%                   --                        9,984
│    └─LayerNorm: 2-8                         [1, 321, 768]             [1, 321, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-9                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-13      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-49              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-50     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-51              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-52             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-37            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-38              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-39            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-14      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-53              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-54     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-55              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-56             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-40            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-41              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-42            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-15      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-57              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-58     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-59              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-60             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-43            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-44              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-45            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-16      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-61              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-62     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-63              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-64             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-46            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-47              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-48            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-17      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-65              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-66     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-67              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-68             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-49            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-50              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-51            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-18      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-69              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-70     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-71              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-72             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-52            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-53              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-54            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-19      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-73              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-74     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-75              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-76             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-55            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-56              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-57            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-20      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-77              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-78     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-79              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-80             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-58            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-59              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-60            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-21      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-81              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-82     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-83              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-84             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-61            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-62              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-63            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-22      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-85              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-86     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-87              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-88             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-64            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-65              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-66            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-23      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-89              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-90     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-91              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-92             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-67            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-68              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-69            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-24      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-93              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-94     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-95              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-96             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-70            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-71              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-72            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    └─LayerNorm: 2-10                        [1, 256, 768]             [1, 256, 768]             1,536                       0.00%                   --                        1,536
│    └─Sequential: 2-11                       [1, 768, 16, 16]          [1, 1024, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-25                      [1, 768, 16, 16]          [1, 1536, 16, 16]         1,181,184                   0.68%                   [1, 1]                    302,383,104
│    │    └─Tanh: 3-26                        [1, 1536, 16, 16]         [1, 1536, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-27                      [1, 1536, 16, 16]         [1, 1024, 16, 16]         1,573,888                   0.90%                   [1, 1]                    402,915,328
│    └─Identity: 2-12                         [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
===================================================================================================================================================================================================
Total params: 174,073,612
Trainable params: 174,073,612
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 37.27
===================================================================================================================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 344.47
Params size (MB): 467.33
Estimated Total Size (MB): 812.58
===================================================================================================================================================================================================
Arguments: ()
[32m[09/01 21:37:49 TiTok]: [39mCreating evaluator.
[32m[09/01 21:37:49 TiTok]: [39mPreparing model, optimizer and dataloaders
[32m[09/01 21:37:49 TiTok]: [39m***** Running training *****
[32m[09/01 21:37:49 TiTok]: [39m  Num training steps = 500000
[32m[09/01 21:37:49 TiTok]: [39m  Gradient Accumulation steps = 1
[32m[09/01 21:37:49 TiTok]: [39mmixed precision = fp16
[32m[09/01 21:37:49 TiTok]: [39m  Total train batch size (w. parallel, distributed & accumulation) = 64
[32m[09/01 21:37:49 TiTok]: [39maccelerator device: cuda
[32m[09/01 21:37:49 TiTok]: [39mAll globbed checkpoints are: []
[32m[09/01 21:37:49 TiTok]: [39mTraining from scratch.
Epoch 0/24 started.

















































































































Training!:   1%|▊                                                                                                                                                 | 199/38555 [04:31<12:12:18,  1.15s/it]
























































































































Training!:   1%|█▌                                                                                                                                                | 398/38555 [08:31<12:29:30,  1.18s/it]






















































































































Training!:   2%|██▎                                                                                                                                               | 599/38555 [12:28<12:25:34,  1.18s/it]






















































































































Training!:   2%|███                                                                                                                                               | 799/38555 [16:24<12:22:26,  1.18s/it]























































































































Training!:   3%|███▊                                                                                                                                             | 1000/38555 [20:23<12:23:14,  1.19s/it]






















































































































Training!:   3%|████▌                                                                                                                                            | 1198/38555 [24:18<12:19:11,  1.19s/it]























































































































Training!:   4%|█████▎                                                                                                                                           | 1399/38555 [28:17<12:11:27,  1.18s/it]























































































































Training!:   4%|██████                                                                                                                                           | 1600/38555 [32:15<12:17:59,  1.20s/it]






















































































































Training!:   5%|██████▊                                                                                                                                          | 1800/38555 [36:12<12:04:51,  1.18s/it]






















































































































Training!:   5%|███████▌                                                                                                                                         | 1999/38555 [40:07<11:59:56,  1.18s/it]






















































































































Training!:   6%|████████▎                                                                                                                                        | 2199/38555 [44:03<11:56:12,  1.18s/it]






















































































































Training!:   6%|█████████                                                                                                                                        | 2399/38555 [47:59<11:31:21,  1.15s/it]





















































































































Training!:   7%|█████████▊                                                                                                                                       | 2600/38555 [51:54<11:50:40,  1.19s/it]






















































































































Training!:   7%|██████████▌                                                                                                                                      | 2800/38555 [55:50<11:44:42,  1.18s/it]





















































































































Training!:   8%|███████████▎                                                                                                                                     | 2999/38555 [59:45<11:41:50,  1.18s/it]






















































































































Training!:   8%|███████████▊                                                                                                                                   | 3199/38555 [1:03:42<11:36:43,  1.18s/it]























































































































Training!:   9%|████████████▌                                                                                                                                  | 3401/38555 [1:07:41<11:33:36,  1.18s/it]






















































































































Training!:   9%|█████████████▎                                                                                                                                 | 3600/38555 [1:11:36<11:28:56,  1.18s/it]






















































































































Training!:  10%|██████████████                                                                                                                                 | 3800/38555 [1:15:33<11:25:31,  1.18s/it]




















































































































Training!:  10%|██████████████▊                                                                                                                                | 3999/38555 [1:19:28<11:22:15,  1.18s/it]























































































































Training!:  11%|███████████████▌                                                                                                                               | 4201/38555 [1:23:27<11:17:37,  1.18s/it]





















































































































Training!:  11%|████████████████▎                                                                                                                              | 4400/38555 [1:27:23<11:18:50,  1.19s/it]





















































































































Training!:  12%|█████████████████                                                                                                                              | 4599/38555 [1:31:17<11:00:07,  1.17s/it]





















































































































Training!:  12%|█████████████████▊                                                                                                                             | 4800/38555 [1:35:11<10:57:08,  1.17s/it]




















































































































Training!:  13%|██████████████████▌                                                                                                                            | 4999/38555 [1:39:04<10:52:27,  1.17s/it]
[32m[09/01 23:16:55 TiTok]: [39mData (t): 0.0230, 54.89/s/gpu Batch (t): 1.1659 LR: 0.000050 Step: 5000 Total Loss: 3.2662 Recon Loss: 3.2609


















































































































Training!:  13%|███████████████████▎                                                                                                                           | 5200/38555 [1:42:56<10:38:59,  1.15s/it]


















































































































Training!:  14%|████████████████████                                                                                                                           | 5398/38555 [1:46:44<10:17:52,  1.12s/it]
















































































































Training!:  15%|████████████████████▊                                                                                                                          | 5599/38555 [1:50:28<10:11:59,  1.11s/it]













































































































Training!:  15%|█████████████████████▌                                                                                                                         | 5798/38555 [1:54:10<10:08:15,  1.11s/it]















































































































Training!:  16%|██████████████████████▏                                                                                                                        | 5998/38555 [1:57:52<10:04:33,  1.11s/it]















































































































Training!:  16%|██████████████████████▉                                                                                                                        | 6199/38555 [2:01:36<10:00:31,  1.11s/it]















































































































Training!:  17%|███████████████████████▉                                                                                                                        | 6399/38555 [2:05:19<9:56:18,  1.11s/it]















































































































Training!:  17%|████████████████████████▋                                                                                                                       | 6598/38555 [2:09:00<9:50:26,  1.11s/it]














































































































Training!:  18%|█████████████████████████▍                                                                                                                      | 6798/38555 [2:12:42<9:46:55,  1.11s/it]














































































































Training!:  18%|██████████████████████████▏                                                                                                                     | 6999/38555 [2:16:25<9:43:34,  1.11s/it]















































































































Training!:  19%|██████████████████████████▉                                                                                                                     | 7199/38555 [2:20:07<9:39:51,  1.11s/it]














































































































Training!:  19%|███████████████████████████▋                                                                                                                    | 7399/38555 [2:23:49<9:36:32,  1.11s/it]















































































































Training!:  20%|████████████████████████████▍                                                                                                                   | 7600/38555 [2:27:32<9:32:36,  1.11s/it]















































































































Training!:  20%|█████████████████████████████▏                                                                                                                  | 7799/38555 [2:31:13<9:29:04,  1.11s/it]
















































































































Training!:  21%|█████████████████████████████▉                                                                                                                  | 8000/38555 [2:35:00<9:54:34,  1.17s/it]


















































































































Training!:  21%|██████████████████████████████▋                                                                                                                 | 8200/38555 [2:38:48<9:34:52,  1.14s/it]


















































































































Training!:  22%|███████████████████████████████▎                                                                                                                | 8400/38555 [2:42:36<9:32:20,  1.14s/it]

















































































































Training!:  22%|████████████████████████████████                                                                                                                | 8599/38555 [2:46:22<9:28:21,  1.14s/it]















































































































Training!:  23%|████████████████████████████████▊                                                                                                               | 8800/38555 [2:50:05<9:07:00,  1.10s/it]















































































































Training!:  23%|█████████████████████████████████▌                                                                                                              | 9000/38555 [2:53:46<9:03:05,  1.10s/it]














































































































Training!:  24%|██████████████████████████████████▎                                                                                                             | 9200/38555 [2:57:27<8:59:28,  1.10s/it]














































































































Training!:  24%|███████████████████████████████████                                                                                                             | 9399/38555 [3:01:07<8:55:47,  1.10s/it]














































































































Training!:  25%|███████████████████████████████████▊                                                                                                            | 9599/38555 [3:04:47<8:51:42,  1.10s/it]















































































































Training!:  25%|████████████████████████████████████▌                                                                                                           | 9799/38555 [3:08:29<8:48:24,  1.10s/it]














































































































Training!:  26%|█████████████████████████████████████▎                                                                                                          | 9999/38555 [3:12:09<8:44:21,  1.10s/it]
[32m[09/02 00:50:00 TiTok]: [39mData (t): 0.0220, 58.10/s/gpu Batch (t): 1.1015 LR: 0.000100 Step: 10000 Total Loss: 2.6933 Recon Loss: 2.6890















































































































Training!:  26%|█████████████████████████████████████▊                                                                                                         | 10200/38555 [3:15:52<8:40:39,  1.10s/it]














































































































Training!:  27%|██████████████████████████████████████▌                                                                                                        | 10399/38555 [3:19:31<8:37:30,  1.10s/it]















































































































Training!:  27%|███████████████████████████████████████▎                                                                                                       | 10600/38555 [3:23:13<8:33:24,  1.10s/it]














































































































Training!:  28%|████████████████████████████████████████                                                                                                       | 10800/38555 [3:26:54<8:29:27,  1.10s/it]














































































































Training!:  29%|████████████████████████████████████████▊                                                                                                      | 10999/38555 [3:30:34<8:26:22,  1.10s/it]















































































































Training!:  29%|█████████████████████████████████████████▌                                                                                                     | 11200/38555 [3:34:16<8:39:50,  1.14s/it]














































































































Training!:  30%|██████████████████████████████████████████▎                                                                                                    | 11400/38555 [3:37:56<8:19:13,  1.10s/it]















































































































Training!:  30%|███████████████████████████████████████████                                                                                                    | 11601/38555 [3:41:39<8:15:45,  1.10s/it]














































































































Training!:  31%|███████████████████████████████████████████▊                                                                                                   | 11801/38555 [3:45:19<8:11:11,  1.10s/it]














































































































Training!:  31%|████████████████████████████████████████████▌                                                                                                  | 12000/38555 [3:48:59<8:20:39,  1.13s/it]













































































































Training!:  32%|█████████████████████████████████████████████▏                                                                                                 | 12198/38555 [3:52:37<8:03:44,  1.10s/it]















































































































Training!:  32%|█████████████████████████████████████████████▉                                                                                                 | 12399/38555 [3:56:19<7:59:40,  1.10s/it]














































































































Training!:  33%|██████████████████████████████████████████████▋                                                                                                | 12599/38555 [3:59:59<7:56:29,  1.10s/it]














































































































Training!:  33%|███████████████████████████████████████████████▍                                                                                               | 12798/38555 [4:03:39<7:52:33,  1.10s/it]















































































































Training!:  34%|████████████████████████████████████████████████▏                                                                                              | 13000/38555 [4:07:22<7:48:54,  1.10s/it]














































































































Training!:  34%|████████████████████████████████████████████████▉                                                                                              | 13199/38555 [4:11:02<7:45:13,  1.10s/it]














































































































Training!:  35%|█████████████████████████████████████████████████▋                                                                                             | 13399/38555 [4:14:42<7:53:19,  1.13s/it]














































































































Training!:  35%|██████████████████████████████████████████████████▍                                                                                            | 13598/38555 [4:18:22<7:37:53,  1.10s/it]















































































































Training!:  36%|███████████████████████████████████████████████████▏                                                                                           | 13799/38555 [4:22:04<7:34:21,  1.10s/it]














































































































Training!:  36%|███████████████████████████████████████████████████▉                                                                                           | 13999/38555 [4:25:44<7:30:20,  1.10s/it]














































































































Training!:  37%|████████████████████████████████████████████████████▋                                                                                          | 14199/38555 [4:29:25<7:26:41,  1.10s/it]














































































































Training!:  37%|█████████████████████████████████████████████████████▍                                                                                         | 14398/38555 [4:33:04<7:23:02,  1.10s/it]















































































































Training!:  38%|██████████████████████████████████████████████████████▏                                                                                        | 14600/38555 [4:36:47<7:19:49,  1.10s/it]














































































































Training!:  38%|██████████████████████████████████████████████████████▉                                                                                        | 14800/38555 [4:40:27<7:16:00,  1.10s/it]














































































































Training!:  39%|███████████████████████████████████████████████████████▋                                                                                       | 14999/38555 [4:44:07<7:11:57,  1.10s/it]
[32m[09/02 02:21:58 TiTok]: [39mData (t): 0.0230, 58.18/s/gpu Batch (t): 1.1001 LR: 0.000100 Step: 15000 Total Loss: 2.5608 Recon Loss: 2.5567















































































































Training!:  39%|████████████████████████████████████████████████████████▍                                                                                      | 15200/38555 [4:47:49<7:09:11,  1.10s/it]














































































































Training!:  40%|█████████████████████████████████████████████████████████                                                                                      | 15399/38555 [4:51:29<7:04:50,  1.10s/it]














































































































Training!:  40%|█████████████████████████████████████████████████████████▊                                                                                     | 15599/38555 [4:55:10<7:01:12,  1.10s/it]















































































































Training!:  41%|██████████████████████████████████████████████████████████▌                                                                                    | 15800/38555 [4:58:52<6:57:24,  1.10s/it]














































































































Training!:  41%|███████████████████████████████████████████████████████████▎                                                                                   | 15999/38555 [5:02:31<6:56:04,  1.11s/it]














































































































Training!:  42%|████████████████████████████████████████████████████████████                                                                                   | 16200/38555 [5:06:13<6:50:03,  1.10s/it]















































































































Training!:  43%|████████████████████████████████████████████████████████████▊                                                                                  | 16400/38555 [5:09:54<6:46:49,  1.10s/it]














































































































Training!:  43%|█████████████████████████████████████████████████████████████▌                                                                                 | 16601/38555 [5:13:35<6:42:56,  1.10s/it]














































































































Training!:  44%|██████████████████████████████████████████████████████████████▎                                                                                | 16800/38555 [5:17:15<6:39:06,  1.10s/it]














































































































Training!:  44%|███████████████████████████████████████████████████████████████                                                                                | 17000/38555 [5:20:55<6:35:37,  1.10s/it]














































































































Training!:  45%|███████████████████████████████████████████████████████████████▊                                                                               | 17199/38555 [5:24:35<6:31:43,  1.10s/it]














































































































Training!:  45%|████████████████████████████████████████████████████████████████▌                                                                              | 17399/38555 [5:28:15<6:28:21,  1.10s/it]















































































































Training!:  46%|█████████████████████████████████████████████████████████████████▎                                                                             | 17600/38555 [5:31:57<6:24:51,  1.10s/it]














































































































Training!:  46%|██████████████████████████████████████████████████████████████████                                                                             | 17800/38555 [5:35:37<6:20:46,  1.10s/it]
















































































































Training!:  47%|██████████████████████████████████████████████████████████████████▊                                                                            | 18001/38555 [5:39:22<6:17:01,  1.10s/it]














































































































Training!:  47%|███████████████████████████████████████████████████████████████████▌                                                                           | 18201/38555 [5:43:02<6:13:53,  1.10s/it]














































































































Training!:  48%|████████████████████████████████████████████████████████████████████▏                                                                          | 18400/38555 [5:46:42<6:09:39,  1.10s/it]














































































































Training!:  48%|████████████████████████████████████████████████████████████████████▉                                                                          | 18600/38555 [5:50:22<6:06:13,  1.10s/it]














































































































Training!:  49%|█████████████████████████████████████████████████████████████████████▋                                                                         | 18799/38555 [5:54:02<6:02:17,  1.10s/it]















































































































Training!:  49%|██████████████████████████████████████████████████████████████████████▍                                                                        | 19001/38555 [5:57:44<6:08:21,  1.13s/it]














































































































Training!:  50%|███████████████████████████████████████████████████████████████████████▏                                                                       | 19200/38555 [6:01:24<5:55:17,  1.10s/it]













































































































Training!:  50%|███████████████████████████████████████████████████████████████████████▉                                                                       | 19398/38555 [6:05:03<5:51:07,  1.10s/it]














































































































Training!:  51%|████████████████████████████████████████████████████████████████████████▋                                                                      | 19598/38555 [6:08:43<5:47:21,  1.10s/it]















































































































Training!:  51%|█████████████████████████████████████████████████████████████████████████▍                                                                     | 19799/38555 [6:12:25<5:43:49,  1.10s/it]














































































































Training!:  52%|██████████████████████████████████████████████████████████████████████████▏                                                                    | 19999/38555 [6:16:05<5:40:13,  1.10s/it]
[32m[09/02 03:53:56 TiTok]: [39mData (t): 0.0240, 53.12/s/gpu Batch (t): 1.2047 LR: 0.000100 Step: 20000 Total Loss: 2.2408 Recon Loss: 2.2369















































































































Training!:  52%|██████████████████████████████████████████████████████████████████████████▉                                                                    | 20199/38555 [6:19:46<5:36:39,  1.10s/it]














































































































Training!:  53%|███████████████████████████████████████████████████████████████████████████▋                                                                   | 20400/38555 [6:23:28<5:33:06,  1.10s/it]














































































































Training!:  53%|████████████████████████████████████████████████████████████████████████████▍                                                                  | 20599/38555 [6:27:07<5:29:13,  1.10s/it]














































































































Training!:  54%|█████████████████████████████████████████████████████████████████████████████▏                                                                 | 20799/38555 [6:30:47<5:25:44,  1.10s/it]















































































































Training!:  54%|█████████████████████████████████████████████████████████████████████████████▉                                                                 | 21000/38555 [6:34:30<5:22:15,  1.10s/it]














































































































Training!:  55%|██████████████████████████████████████████████████████████████████████████████▋                                                                | 21200/38555 [6:38:10<5:29:10,  1.14s/it]














































































































Training!:  56%|███████████████████████████████████████████████████████████████████████████████▎                                                               | 21399/38555 [6:41:50<5:14:37,  1.10s/it]














































































































Training!:  56%|████████████████████████████████████████████████████████████████████████████████                                                               | 21599/38555 [6:45:31<5:10:39,  1.10s/it]














































































































Training!:  57%|████████████████████████████████████████████████████████████████████████████████▊                                                              | 21799/38555 [6:49:11<5:07:08,  1.10s/it]















































































































Training!:  57%|█████████████████████████████████████████████████████████████████████████████████▌                                                             | 22000/38555 [6:52:53<5:03:49,  1.10s/it]














































































































Training!:  58%|██████████████████████████████████████████████████████████████████████████████████▎                                                            | 22200/38555 [6:56:33<4:59:55,  1.10s/it]














































































































Training!:  58%|███████████████████████████████████████████████████████████████████████████████████                                                            | 22399/38555 [7:00:12<4:56:17,  1.10s/it]














































































































Training!:  59%|███████████████████████████████████████████████████████████████████████████████████▊                                                           | 22599/38555 [7:03:53<4:52:40,  1.10s/it]














































































































Training!:  59%|████████████████████████████████████████████████████████████████████████████████████▌                                                          | 22799/38555 [7:07:33<4:49:12,  1.10s/it]














































































































Training!:  60%|█████████████████████████████████████████████████████████████████████████████████████▎                                                         | 22999/38555 [7:11:13<4:45:21,  1.10s/it]















































































































Training!:  60%|██████████████████████████████████████████████████████████████████████████████████████                                                         | 23200/38555 [7:14:55<4:41:38,  1.10s/it]














































































































Training!:  61%|██████████████████████████████████████████████████████████████████████████████████████▊                                                        | 23399/38555 [7:18:35<4:41:20,  1.11s/it]














































































































Training!:  61%|███████████████████████████████████████████████████████████████████████████████████████▌                                                       | 23599/38555 [7:22:15<4:34:28,  1.10s/it]















































































































Training!:  62%|████████████████████████████████████████████████████████████████████████████████████████▎                                                      | 23800/38555 [7:25:58<4:30:43,  1.10s/it]














































































































Training!:  62%|█████████████████████████████████████████████████████████████████████████████████████████                                                      | 24000/38555 [7:29:38<4:34:53,  1.13s/it]














































































































Training!:  63%|█████████████████████████████████████████████████████████████████████████████████████████▊                                                     | 24200/38555 [7:33:19<4:23:16,  1.10s/it]














































































































Training!:  63%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                    | 24399/38555 [7:36:58<4:20:01,  1.10s/it]















































































































Training!:  64%|███████████████████████████████████████████████████████████████████████████████████████████▏                                                   | 24601/38555 [7:40:41<4:16:06,  1.10s/it]














































































































Training!:  64%|███████████████████████████████████████████████████████████████████████████████████████████▉                                                   | 24801/38555 [7:44:21<4:12:32,  1.10s/it]














































































































Training!:  65%|████████████████████████████████████████████████████████████████████████████████████████████▋                                                  | 24999/38555 [7:48:00<4:08:41,  1.10s/it]
[32m[09/02 05:25:51 TiTok]: [39mData (t): 0.0230, 58.17/s/gpu Batch (t): 1.1002 LR: 0.000100 Step: 25000 Total Loss: 2.2327 Recon Loss: 2.2288














































































































Training!:  65%|█████████████████████████████████████████████████████████████████████████████████████████████▍                                                 | 25201/38555 [7:51:43<4:12:58,  1.14s/it]














































































































Training!:  66%|██████████████████████████████████████████████████████████████████████████████████████████████▏                                                | 25400/38555 [7:55:23<4:01:20,  1.10s/it]














































































































Training!:  66%|██████████████████████████████████████████████████████████████████████████████████████████████▉                                                | 25600/38555 [7:59:04<3:57:36,  1.10s/it]














































































































Training!:  67%|███████████████████████████████████████████████████████████████████████████████████████████████▋                                               | 25800/38555 [8:02:44<3:54:30,  1.10s/it]














































































































Training!:  67%|████████████████████████████████████████████████████████████████████████████████████████████████▍                                              | 26001/38555 [8:06:26<3:50:18,  1.10s/it]













































































































Training!:  68%|█████████████████████████████████████████████████████████████████████████████████████████████████▏                                             | 26199/38555 [8:10:04<3:46:36,  1.10s/it]














































































































Training!:  68%|█████████████████████████████████████████████████████████████████████████████████████████████████▉                                             | 26398/38555 [8:13:44<3:42:58,  1.10s/it]














































































































Training!:  69%|██████████████████████████████████████████████████████████████████████████████████████████████████▋                                            | 26598/38555 [8:17:24<3:39:22,  1.10s/it]















































































































Training!:  70%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                           | 26799/38555 [8:21:06<3:35:30,  1.10s/it]













































































































Training!:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                          | 26999/38555 [8:24:46<3:31:59,  1.10s/it]














































































































Training!:  71%|████████████████████████████████████████████████████████████████████████████████████████████████████▉                                          | 27199/38555 [8:28:27<3:28:36,  1.10s/it]














































































































Training!:  71%|█████████████████████████████████████████████████████████████████████████████████████████████████████▋                                         | 27400/38555 [8:32:09<3:24:32,  1.10s/it]











































































































Training!:  72%|██████████████████████████████████████████████████████████████████████████████████████████████████████▎                                        | 27598/38555 [8:35:46<3:20:59,  1.10s/it]















































































































Training!:  72%|███████████████████████████████████████████████████████████████████████████████████████████████████████                                        | 27799/38555 [8:39:29<3:17:15,  1.10s/it]














































































































Training!:  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                                       | 27999/38555 [8:43:09<3:13:31,  1.10s/it]














































































































Training!:  73%|████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                      | 28199/38555 [8:46:50<3:09:50,  1.10s/it]














































































































Training!:  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                     | 28399/38555 [8:50:30<3:06:20,  1.10s/it]















































































































Training!:  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████                                     | 28600/38555 [8:54:12<3:02:36,  1.10s/it]













































































































Training!:  75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                    | 28800/38555 [8:57:52<3:04:38,  1.14s/it]














































































































Training!:  75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                   | 28999/38555 [9:01:31<2:55:12,  1.10s/it]













































































































Training!:  76%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                  | 29198/38555 [9:05:11<2:51:31,  1.10s/it]














































































































Training!:  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████                                  | 29399/38555 [9:08:52<2:47:56,  1.10s/it]















































































































Training!:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 29600/38555 [9:12:34<2:44:10,  1.10s/it]













































































































Training!:  77%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                | 29800/38555 [9:16:14<2:40:30,  1.10s/it]













































































































Training!:  78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                               | 29999/38555 [9:19:54<2:36:42,  1.10s/it]
[32m[09/02 06:57:45 TiTok]: [39mData (t): 0.0230, 58.23/s/gpu Batch (t): 1.0990 LR: 0.000100 Step: 30000 Total Loss: 2.0952 Recon Loss: 2.0913














































































































Training!:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████                               | 30200/38555 [9:23:35<2:32:49,  1.10s/it]














































































































Training!:  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                              | 30400/38555 [9:27:15<2:29:09,  1.10s/it]














































































































Training!:  79%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                             | 30600/38555 [9:30:55<2:25:32,  1.10s/it]














































































































Training!:  80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                            | 30800/38555 [9:34:35<2:21:48,  1.10s/it]














































































































Training!:  80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                            | 31000/38555 [9:38:15<2:18:28,  1.10s/it]














































































































Training!:  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                           | 31201/38555 [9:41:56<2:14:31,  1.10s/it]













































































































Training!:  81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                          | 31399/38555 [9:45:33<2:10:48,  1.10s/it]














































































































Training!:  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                         | 31600/38555 [9:49:14<2:07:13,  1.10s/it]














































































































Training!:  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                         | 31800/38555 [9:52:54<2:03:26,  1.10s/it]














































































































Training!:  83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                        | 32001/38555 [9:56:34<2:01:04,  1.11s/it]














































































































Training!:  84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                       | 32201/38555 [10:00:14<1:56:07,  1.10s/it]













































































































Training!:  84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                      | 32400/38555 [10:03:52<1:52:27,  1.10s/it]














































































































Training!:  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                      | 32600/38555 [10:07:32<1:48:52,  1.10s/it]














































































































Training!:  85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                     | 32800/38555 [10:11:12<1:48:30,  1.13s/it]













































































































Training!:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                    | 32999/38555 [10:14:51<1:41:41,  1.10s/it]














































































































Training!:  86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                   | 33199/38555 [10:18:31<1:37:53,  1.10s/it]













































































































Training!:  87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 33398/38555 [10:22:09<1:34:19,  1.10s/it]














































































































Training!:  87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                  | 33598/38555 [10:25:49<1:30:37,  1.10s/it]














































































































Training!:  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                 | 33798/38555 [10:29:29<1:27:02,  1.10s/it]














































































































Training!:  88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                | 33999/38555 [10:33:10<1:23:17,  1.10s/it]














































































































Training!:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                | 34200/38555 [10:36:50<1:19:36,  1.10s/it]














































































































Training!:  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 34399/38555 [10:40:29<1:15:55,  1.10s/it]













































































































Training!:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 34598/38555 [10:44:08<1:12:14,  1.10s/it]














































































































Training!:  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏             | 34798/38555 [10:47:48<1:08:40,  1.10s/it]














































































































Training!:  91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉             | 34999/38555 [10:51:29<1:05:10,  1.10s/it]
[32m[09/02 08:29:20 TiTok]: [39mData (t): 0.0230, 58.33/s/gpu Batch (t): 1.0973 LR: 0.000099 Step: 35000 Total Loss: 2.0502 Recon Loss: 2.0464















































































































Training!:  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋            | 35201/38555 [10:55:11<1:01:21,  1.10s/it]













































































































Training!:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏           | 35398/38555 [10:58:48<57:43,  1.10s/it]














































































































Training!:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉           | 35599/38555 [11:02:29<54:04,  1.10s/it]














































































































Training!:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋          | 35799/38555 [11:06:09<50:23,  1.10s/it]














































































































Training!:  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍         | 36000/38555 [11:09:49<48:01,  1.13s/it]














































































































Training!:  94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏        | 36200/38555 [11:13:30<43:05,  1.10s/it]














































































































Training!:  94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉        | 36400/38555 [11:17:09<39:23,  1.10s/it]

















































































































Training!:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋       | 36600/38555 [11:20:56<36:49,  1.13s/it]

















































































































Training!:  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍      | 36799/38555 [11:24:41<33:21,  1.14s/it]

















































































































Training!:  96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏     | 36999/38555 [11:28:28<29:24,  1.13s/it]















































































































Training!:  96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉     | 37200/38555 [11:32:10<24:54,  1.10s/it]















































































































Training!:  97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋    | 37399/38555 [11:35:52<21:28,  1.11s/it]
















































































































Training!:  98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 37599/38555 [11:39:36<17:46,  1.12s/it]
















































































































Training!:  98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏  | 37800/38555 [11:43:20<14:01,  1.11s/it]
















































































































Training!:  99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 38001/38555 [11:47:05<10:18,  1.12s/it]















































































































Training!:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 38200/38555 [11:50:47<06:40,  1.13s/it]
















































































































Training!: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 38400/38555 [11:54:31<02:53,  1.12s/it]























































































Training!: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 38555/38555 [11:57:26<00:00,  1.75s/it]
Training!: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 38555/38555 [11:57:28<00:00,  1.12s/it]

























Training!:   0%|▏                                                                                                                                                  | 45/38555 [01:39<11:48:37,  1.10s/it]

















































































































Training!:   1%|▉                                                                                                                                                 | 246/38555 [05:25<11:50:43,  1.11s/it]















































































































Training!:   1%|█▋                                                                                                                                                | 444/38555 [09:06<11:47:03,  1.11s/it]
















































































































Training!:   2%|██▍                                                                                                                                               | 646/38555 [12:52<11:44:56,  1.12s/it]
















































































































Training!:   2%|███▏                                                                                                                                              | 844/38555 [16:36<11:37:06,  1.11s/it]

















































































































Training!:   3%|███▉                                                                                                                                             | 1044/38555 [20:22<11:48:29,  1.13s/it]





































































































Training!:   3%|████▋                                                                                                                                            | 1244/38555 [24:12<11:54:02,  1.15s/it]




















































































































Training!:   4%|█████▍                                                                                                                                           | 1443/38555 [28:06<12:26:30,  1.21s/it]

Training!:   4%|█████▍                                                                                                                                           | 1444/38555 [28:07<12:28:12,  1.21s/it]



















































































































Training!:   4%|██████▏                                                                                                                                          | 1645/38555 [31:59<12:00:40,  1.17s/it]

















































































































Training!:   5%|██████▉                                                                                                                                          | 1844/38555 [35:45<11:24:09,  1.12s/it]
















































































































Training!:   5%|███████▋                                                                                                                                         | 2044/38555 [39:29<11:21:28,  1.12s/it]


















































































































Training!:   6%|████████▍                                                                                                                                        | 2245/38555 [43:19<11:16:12,  1.12s/it]



















































































































Training!:   6%|█████████▏                                                                                                                                       | 2443/38555 [47:09<11:22:44,  1.13s/it]


















































































































Training!:   7%|█████████▉                                                                                                                                       | 2644/38555 [50:57<11:19:14,  1.13s/it]


















































































































Training!:   7%|██████████▋                                                                                                                                      | 2844/38555 [54:45<11:39:24,  1.18s/it]

















































































































Training!:   8%|███████████▍                                                                                                                                     | 3043/38555 [58:31<11:11:37,  1.13s/it]


















































































































Training!:   8%|████████████                                                                                                                                   | 3244/38555 [1:02:20<11:08:32,  1.14s/it]


















































































































Training!:   9%|████████████▊                                                                                                                                  | 3444/38555 [1:06:07<11:03:53,  1.13s/it]


















































































































Training!:   9%|█████████████▌                                                                                                                                 | 3645/38555 [1:09:56<11:00:44,  1.14s/it]

















































































































Training!:  10%|██████████████▎                                                                                                                                | 3844/38555 [1:13:42<10:56:45,  1.14s/it]


















































































































Training!:  10%|██████████████▉                                                                                                                                | 4044/38555 [1:17:30<10:54:02,  1.14s/it]


















































































































Training!:  11%|███████████████▋                                                                                                                               | 4244/38555 [1:21:18<11:11:35,  1.17s/it]


















































































































Training!:  12%|████████████████▍                                                                                                                              | 4445/38555 [1:25:06<10:46:11,  1.14s/it]

















































































































Training!:  12%|█████████████████▏                                                                                                                             | 4644/38555 [1:28:53<10:42:00,  1.14s/it]


















































































































Training!:  13%|█████████████████▉                                                                                                                             | 4844/38555 [1:32:40<10:37:47,  1.14s/it]


















































































































Training!:  13%|██████████████████▋                                                                                                                            | 5045/38555 [1:36:29<10:34:05,  1.14s/it]


















































































































Training!:  14%|███████████████████▍                                                                                                                           | 5245/38555 [1:40:16<10:30:34,  1.14s/it]

















































































































Training!:  14%|████████████████████▏                                                                                                                          | 5444/38555 [1:44:03<10:27:19,  1.14s/it]



















































































































Training!:  15%|████████████████████▉                                                                                                                          | 5646/38555 [1:47:54<10:23:58,  1.14s/it]

















































































































Training!:  15%|█████████████████████▋                                                                                                                         | 5845/38555 [1:51:40<10:19:44,  1.14s/it]




















































































































Training!:  16%|██████████████████████▍                                                                                                                        | 6045/38555 [1:55:31<10:16:48,  1.14s/it]


















































































































Training!:  16%|███████████████████████▏                                                                                                                       | 6246/38555 [1:59:20<10:13:44,  1.14s/it]


















































































































Training!:  17%|███████████████████████▉                                                                                                                       | 6445/38555 [2:03:08<12:43:10,  1.43s/it]
[32m[09/02 11:38:26 TiTok]: [39mData (t): 0.0240, 56.31/s/gpu Batch (t): 1.1366 LR: 0.000099 Step: 45000 Total Loss: 1.9231 Recon Loss: 1.9193

















































































































Training!:  17%|████████████████████████▋                                                                                                                      | 6644/38555 [2:06:54<10:04:39,  1.14s/it]



















































































































Training!:  18%|█████████████████████████▍                                                                                                                     | 6846/38555 [2:10:44<10:00:57,  1.14s/it]

















































































































Training!:  18%|██████████████████████████▎                                                                                                                     | 7044/38555 [2:14:30<9:56:46,  1.14s/it]


















































































































Training!:  19%|███████████████████████████                                                                                                                     | 7245/38555 [2:18:18<9:53:40,  1.14s/it]


















































































































Training!:  19%|███████████████████████████▊                                                                                                                    | 7445/38555 [2:22:07<9:48:54,  1.14s/it]


















































































































Training!:  20%|████████████████████████████▌                                                                                                                   | 7645/38555 [2:25:54<9:45:46,  1.14s/it]




















































































































Training!:  20%|█████████████████████████████▎                                                                                                                  | 7845/38555 [2:29:47<9:51:23,  1.16s/it]



















































































































Training!:  21%|██████████████████████████████                                                                                                                  | 8044/38555 [2:33:37<9:58:26,  1.18s/it]

















































































































Training!:  21%|██████████████████████████████▊                                                                                                                 | 8244/38555 [2:37:24<9:31:15,  1.13s/it]



















































































































Training!:  22%|███████████████████████████████▌                                                                                                                | 8444/38555 [2:41:14<9:34:46,  1.15s/it]


















































































































Training!:  22%|████████████████████████████████▎                                                                                                               | 8643/38555 [2:45:01<9:31:13,  1.15s/it]



















































































































Training!:  23%|█████████████████████████████████                                                                                                               | 8843/38555 [2:48:51<9:28:14,  1.15s/it]



















































































































Training!:  23%|█████████████████████████████████▊                                                                                                              | 9044/38555 [2:52:42<9:23:45,  1.15s/it]



















































































































Training!:  24%|██████████████████████████████████▌                                                                                                             | 9244/38555 [2:56:32<9:19:31,  1.15s/it]


















































































































Training!:  24%|███████████████████████████████████▎                                                                                                            | 9444/38555 [3:00:22<9:34:24,  1.18s/it]



















































































































Training!:  25%|████████████████████████████████████                                                                                                            | 9645/38555 [3:04:12<9:13:33,  1.15s/it]


















































































































Training!:  26%|████████████████████████████████████▊                                                                                                           | 9843/38555 [3:08:00<9:08:08,  1.15s/it]



















































































































Training!:  26%|█████████████████████████████████████▎                                                                                                         | 10044/38555 [3:11:50<9:04:34,  1.15s/it]



















































































































Training!:  27%|█████████████████████████████████████▉                                                                                                         | 10244/38555 [3:15:40<9:00:38,  1.15s/it]


















































































































Training!:  27%|██████████████████████████████████████▋                                                                                                        | 10444/38555 [3:19:30<8:56:42,  1.15s/it]




















































































































Training!:  28%|███████████████████████████████████████▍                                                                                                       | 10645/38555 [3:23:21<8:52:48,  1.15s/it]


















































































































Training!:  28%|████████████████████████████████████████▏                                                                                                      | 10844/38555 [3:27:10<8:49:10,  1.15s/it]



















































































































Training!:  29%|████████████████████████████████████████▉                                                                                                      | 11044/38555 [3:30:59<8:45:48,  1.15s/it]



















































































































Training!:  29%|█████████████████████████████████████████▋                                                                                                     | 11245/38555 [3:34:50<8:41:41,  1.15s/it]


















































































































Training!:  30%|██████████████████████████████████████████▍                                                                                                    | 11444/38555 [3:38:38<8:38:13,  1.15s/it]
[32m[09/02 13:13:58 TiTok]: [39mData (t): 0.0230, 55.89/s/gpu Batch (t): 1.1451 LR: 0.000099 Step: 50000 Total Loss: 1.9262 Recon Loss: 1.9225
Model weights saved in titok_b_64_stage1_run1\checkpoint-50000\unwrapped_model\pytorch_model.bin
[32m[09/02 13:13:58 TiTok]: [39mSaved state to titok_b_64_stage1_run1\checkpoint-50000
Model weights saved in titok_b_64_stage1_run1\checkpoint-50000\ema_model\pytorch_model.bin
[32m[09/02 13:14:01 TiTok]: [39mReconstructing images...
Training!:  30%|██████████████████████████████████████████▍                                                                                                    | 11444/38555 [3:39:33<8:40:08,  1.15s/it]
Traceback (most recent call last):
  File "E:\SLT_FYP\1d-tokenizer\scripts\train_titok.py", line 181, in <module>
    main()
  File "E:\SLT_FYP\1d-tokenizer\scripts\train_titok.py", line 142, in main
    global_step = train_one_epoch(config, logger, accelerator,
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\SLT_FYP\1d-tokenizer\utils\train_utils.py", line 487, in train_one_epoch
    eval_scores = eval_reconstruction(
                  ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\SLT_FYP\1d-tokenizer\utils\train_utils.py", line 551, in eval_reconstruction
    images = batch["image"].to(
             ~~~~~^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\_device.py", line 78, in __torch_function__
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
IndexError: too many indices for tensor of dimension 4