[32m[09/01 21:07:55 TiTok]: [39mSaving config to titok_b_64_stage1_run1\config.yaml
[32m[09/01 21:07:55 TiTok]: [39mConfig:
experiment:
  project: titok_b_64_stage1
  name: titok_b_64_stage1_run1
  output_dir: titok_b_64_stage1_run1
  max_train_examples: 1281167
  save_every: 50000
  eval_every: 50000
  generate_every: 5000
  log_every: 50
  log_grad_norm_every: 1000
  resume: true
  init_weight: ''
  logging_dir: titok_b_64_stage1_run1\logs
model:
  vq_model:
    codebook_size: 4096
    token_size: 12
    use_l2_norm: true
    commitment_cost: 0.25
    vit_enc_model_size: base
    vit_dec_model_size: base
    vit_enc_patch_size: 16
    vit_dec_patch_size: 16
    num_latent_tokens: 64
    finetune_decoder: false
    pretrained_tokenizer_weight: maskgit-vqgan-imagenet-f16-256.bin
losses:
  quantizer_weight: 1.0
dataset:
  params:
    params: null
    img_path: ../../CSL-Daily/sentence/frames_512x512/
    num_workers_per_gpu: 12
  preprocessing:
    resize_shorter_edge: 256
    crop_size: 256
    random_crop: true
    random_flip: true
optimizer:
  name: adamw
  params:
    learning_rate: 0.0001
    beta1: 0.9
    beta2: 0.99
    weight_decay: 0.0001
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 10000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 64
  mixed_precision: fp16
  enable_tf32: true
  enable_wandb: true
  use_ema: true
  seed: 42
  max_train_steps: 500000
  num_generated_images: 2
  max_grad_norm: 1.0
config: configs/training/stage1/titok_b64_CSL.yaml
--experiment:
  project: titok_b64_CSL_stage1
  name: titok_b64_CSL_stage1_run1
  output_dir: titok_b64_CSL_stage1_run1
--training:
  per_gpu_batch_size: 32
[32m[09/01 21:07:56 TiTok]: [39mCreating model and loss module.
===================================================================================================================================================================================================
Layer (type:depth-idx)                        Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
===================================================================================================================================================================================================
TiTok                                         [1, 3, 256, 256]          [1, 1024, 16, 16]         49,152                      0.03%                   --                        --
├─TiTokEncoder: 1-1                           --                        [1, 12, 1, 64]            247,296                     0.14%                   --                        --
│    └─Conv2d: 2-1                            [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.34%                   [16, 16]                  151,191,552
│    └─LayerNorm: 2-2                         [1, 321, 768]             [1, 321, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-3                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-1       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-1               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-2      [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-3               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-4              [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-1             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-2               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-3             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-2       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-5               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-6      [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-7               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-8              [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-4             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-5               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-6             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-3       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-9               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-10     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-11              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-12             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-7             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-8               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-9             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-4       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-13              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-14     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-15              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-16             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-10            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-11              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-12            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-5       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-17              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-18     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-19              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-20             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-13            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-14              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-15            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-6       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-21              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-22     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-23              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-24             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-16            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-17              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-18            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-7       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-25              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-26     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-27              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-28             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-19            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-20              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-21            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-8       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-29              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-30     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-31              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-32             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-22            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-23              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-24            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-9       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-33              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-34     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-35              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-36             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-25            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-26              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-27            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-10      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-37              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-38     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-39              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-40             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-28            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-29              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-30            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-11      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-41              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-42     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-43              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-44             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-31            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-32              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-33            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-12      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-45              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-46     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-47              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-48             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-34            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-35              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-36            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    └─LayerNorm: 2-4                         [1, 64, 768]              [1, 64, 768]              1,536                       0.00%                   --                        1,536
│    └─Conv2d: 2-5                            [1, 768, 64, 1]           [1, 12, 64, 1]            9,228                       0.01%                   [1, 1]                    590,592
├─VectorQuantizer: 1-2                        [1, 12, 1, 64]            [1, 12, 1, 64]            --                             --                   --                        --
│    └─Embedding: 2-6                         [64]                      [64, 12]                  49,152                      0.03%                   --                        3,145,728
├─TiTokDecoder: 1-3                           [1, 12, 1, 64]            [1, 1024, 16, 16]         248,064                     0.14%                   --                        --
│    └─Linear: 2-7                            [1, 64, 12]               [1, 64, 768]              9,984                       0.01%                   --                        9,984
│    └─LayerNorm: 2-8                         [1, 321, 768]             [1, 321, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-9                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-13      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-49              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-50     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-51              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-52             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-37            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-38              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-39            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-14      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-53              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-54     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-55              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-56             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-40            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-41              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-42            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-15      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-57              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-58     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-59              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-60             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-43            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-44              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-45            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-16      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-61              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-62     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-63              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-64             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-46            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-47              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-48            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-17      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-65              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-66     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-67              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-68             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-49            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-50              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-51            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-18      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-69              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-70     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-71              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-72             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-52            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-53              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-54            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-19      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-73              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-74     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-75              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-76             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-55            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-56              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-57            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-20      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-77              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-78     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-79              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-80             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-58            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-59              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-60            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-21      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-81              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-82     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-83              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-84             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-61            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-62              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-63            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-22      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-85              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-86     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-87              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-88             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-64            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-65              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-66            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-23      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-89              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-90     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-91              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-92             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-67            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-68              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-69            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-24      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-93              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-94     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-95              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-96             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-70            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-71              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-72            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    └─LayerNorm: 2-10                        [1, 256, 768]             [1, 256, 768]             1,536                       0.00%                   --                        1,536
│    └─Sequential: 2-11                       [1, 768, 16, 16]          [1, 1024, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-25                      [1, 768, 16, 16]          [1, 1536, 16, 16]         1,181,184                   0.68%                   [1, 1]                    302,383,104
│    │    └─Tanh: 3-26                        [1, 1536, 16, 16]         [1, 1536, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-27                      [1, 1536, 16, 16]         [1, 1024, 16, 16]         1,573,888                   0.90%                   [1, 1]                    402,915,328
│    └─Identity: 2-12                         [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
===================================================================================================================================================================================================
Total params: 174,073,612
Trainable params: 174,073,612
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 37.27
===================================================================================================================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 344.47
Params size (MB): 467.33
Estimated Total Size (MB): 812.58
===================================================================================================================================================================================================
[32m[09/01 21:07:56 TiTok]: [39m===================================================================================================================================================================================================
Layer (type:depth-idx)                        Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
===================================================================================================================================================================================================
TiTok                                         [1, 3, 256, 256]          [1, 1024, 16, 16]         49,152                      0.03%                   --                        --
├─TiTokEncoder: 1-1                           --                        [1, 12, 1, 64]            247,296                     0.14%                   --                        --
│    └─Conv2d: 2-1                            [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.34%                   [16, 16]                  151,191,552
│    └─LayerNorm: 2-2                         [1, 321, 768]             [1, 321, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-3                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-1       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-1               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-2      [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-3               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-4              [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-1             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-2               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-3             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-2       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-5               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-6      [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-7               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-8              [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-4             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-5               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-6             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-3       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-9               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-10     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-11              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-12             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-7             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-8               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-9             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-4       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-13              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-14     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-15              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-16             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-10            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-11              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-12            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-5       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-17              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-18     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-19              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-20             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-13            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-14              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-15            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-6       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-21              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-22     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-23              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-24             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-16            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-17              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-18            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-7       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-25              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-26     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-27              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-28             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-19            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-20              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-21            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-8       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-29              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-30     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-31              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-32             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-22            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-23              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-24            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-9       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-33              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-34     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-35              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-36             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-25            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-26              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-27            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-10      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-37              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-38     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-39              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-40             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-28            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-29              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-30            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-11      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-41              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-42     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-43              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-44             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-31            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-32              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-33            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-12      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-45              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-46     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-47              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-48             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-34            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-35              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-36            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    └─LayerNorm: 2-4                         [1, 64, 768]              [1, 64, 768]              1,536                       0.00%                   --                        1,536
│    └─Conv2d: 2-5                            [1, 768, 64, 1]           [1, 12, 64, 1]            9,228                       0.01%                   [1, 1]                    590,592
├─VectorQuantizer: 1-2                        [1, 12, 1, 64]            [1, 12, 1, 64]            --                             --                   --                        --
│    └─Embedding: 2-6                         [64]                      [64, 12]                  49,152                      0.03%                   --                        3,145,728
├─TiTokDecoder: 1-3                           [1, 12, 1, 64]            [1, 1024, 16, 16]         248,064                     0.14%                   --                        --
│    └─Linear: 2-7                            [1, 64, 12]               [1, 64, 768]              9,984                       0.01%                   --                        9,984
│    └─LayerNorm: 2-8                         [1, 321, 768]             [1, 321, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-9                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-13      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-49              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-50     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-51              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-52             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-37            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-38              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-39            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-14      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-53              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-54     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-55              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-56             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-40            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-41              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-42            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-15      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-57              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-58     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-59              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-60             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-43            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-44              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-45            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-16      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-61              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-62     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-63              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-64             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-46            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-47              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-48            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-17      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-65              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-66     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-67              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-68             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-49            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-50              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-51            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-18      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-69              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-70     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-71              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-72             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-52            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-53              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-54            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-19      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-73              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-74     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-75              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-76             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-55            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-56              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-57            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-20      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-77              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-78     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-79              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-80             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-58            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-59              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-60            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-21      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-81              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-82     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-83              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-84             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-61            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-62              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-63            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-22      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-85              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-86     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-87              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-88             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-64            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-65              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-66            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-23      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-89              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-90     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-91              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-92             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-67            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-68              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-69            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-24      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-93              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-94     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-95              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-96             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-70            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-71              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-72            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    └─LayerNorm: 2-10                        [1, 256, 768]             [1, 256, 768]             1,536                       0.00%                   --                        1,536
│    └─Sequential: 2-11                       [1, 768, 16, 16]          [1, 1024, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-25                      [1, 768, 16, 16]          [1, 1536, 16, 16]         1,181,184                   0.68%                   [1, 1]                    302,383,104
│    │    └─Tanh: 3-26                        [1, 1536, 16, 16]         [1, 1536, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-27                      [1, 1536, 16, 16]         [1, 1024, 16, 16]         1,573,888                   0.90%                   [1, 1]                    402,915,328
│    └─Identity: 2-12                         [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
===================================================================================================================================================================================================
Total params: 174,073,612
Trainable params: 174,073,612
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 37.27
===================================================================================================================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 344.47
Params size (MB): 467.33
Estimated Total Size (MB): 812.58
===================================================================================================================================================================================================
[32m[09/01 21:07:56 TiTok]: [39mCreating optimizers.
[32m[09/01 21:07:56 TiTok]: [39mCreating lr_schedulers.
[32m[09/01 21:07:56 TiTok]: [39mCreating dataloaders. Batch size = 64
C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\nn\functional.py:5504: UserWarning: 1Torch was not compiled with flash attention. (Triggered internally at ..\aten\src\ATen\native\transformers\cuda\sdp_utils.cpp:455.)
  attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1113, in emit
    stream.write(msg + self.terminator)
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode characters in position 794-795: character maps to <undefined>
Call stack:
  File "E:\SLT_FYP\1d-tokenizer\scripts\train_titok.py", line 181, in <module>
    main()
  File "E:\SLT_FYP\1d-tokenizer\scripts\train_titok.py", line 90, in main
    model, ema_model, loss_module = create_model_and_loss_module(
  File "E:\SLT_FYP\1d-tokenizer\utils\train_utils.py", line 144, in create_model_and_loss_module
    logger.info(model_summary_str)
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1849, in info
    self.log(INFO, msg, *args, **kwargs)
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\accelerate\logging.py", line 63, in log
    self.logger.log(level, msg, *args, **kwargs)
Message: ===================================================================================================================================================================================================
Layer (type:depth-idx)                        Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
===================================================================================================================================================================================================
TiTok                                         [1, 3, 256, 256]          [1, 1024, 16, 16]         49,152                      0.03%                   --                        --
├─TiTokEncoder: 1-1                           --                        [1, 12, 1, 64]            247,296                     0.14%                   --                        --
│    └─Conv2d: 2-1                            [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.34%                   [16, 16]                  151,191,552
│    └─LayerNorm: 2-2                         [1, 321, 768]             [1, 321, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-3                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-1       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-1               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-2      [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-3               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-4              [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-1             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-2               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-3             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-2       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-5               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-6      [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-7               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-8              [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-4             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-5               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-6             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-3       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-9               [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-10     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-11              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-12             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-7             [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-8               [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-9             [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-4       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-13              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-14     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-15              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-16             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-10            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-11              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-12            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-5       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-17              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-18     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-19              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-20             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-13            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-14              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-15            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-6       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-21              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-22     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-23              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-24             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-16            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-17              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-18            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-7       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-25              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-26     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-27              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-28             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-19            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-20              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-21            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-8       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-29              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-30     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-31              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-32             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-22            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-23              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-24            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-9       [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-33              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-34     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-35              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-36             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-25            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-26              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-27            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-10      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-37              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-38     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-39              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-40             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-28            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-29              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-30            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-11      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-41              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-42     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-43              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-44             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-31            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-32              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-33            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-12      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-45              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-46     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-47              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-48             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-34            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-35              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-36            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    └─LayerNorm: 2-4                         [1, 64, 768]              [1, 64, 768]              1,536                       0.00%                   --                        1,536
│    └─Conv2d: 2-5                            [1, 768, 64, 1]           [1, 12, 64, 1]            9,228                       0.01%                   [1, 1]                    590,592
├─VectorQuantizer: 1-2                        [1, 12, 1, 64]            [1, 12, 1, 64]            --                             --                   --                        --
│    └─Embedding: 2-6                         [64]                      [64, 12]                  49,152                      0.03%                   --                        3,145,728
├─TiTokDecoder: 1-3                           [1, 12, 1, 64]            [1, 1024, 16, 16]         248,064                     0.14%                   --                        --
│    └─Linear: 2-7                            [1, 64, 12]               [1, 64, 768]              9,984                       0.01%                   --                        9,984
│    └─LayerNorm: 2-8                         [1, 321, 768]             [1, 321, 768]             1,536                       0.00%                   --                        1,536
│    └─ModuleList: 2-9                        --                        --                        --                             --                   --                        --
│    │    └─ResidualAttentionBlock: 3-13      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-49              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-50     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-51              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-52             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-37            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-38              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-39            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-14      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-53              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-54     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-55              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-56             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-40            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-41              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-42            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-15      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-57              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-58     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-59              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-60             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-43            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-44              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-45            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-16      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-61              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-62     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-63              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-64             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-46            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-47              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-48            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-17      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-65              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-66     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-67              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-68             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-49            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-50              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-51            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-18      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-69              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-70     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-71              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-72             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-52            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-53              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-54            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-19      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-73              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-74     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-75              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-76             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-55            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-56              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-57            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-20      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-77              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-78     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-79              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-80             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-58            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-59              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-60            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-21      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-81              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-82     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-83              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-84             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-61            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-62              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-63            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-22      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-85              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-86     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-87              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-88             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-64            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-65              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-66            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-23      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-89              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-90     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-91              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-92             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-67            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-68              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-69            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    │    └─ResidualAttentionBlock: 3-24      [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    └─LayerNorm: 4-93              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─MultiheadAttention: 4-94     [321, 1, 768]             [321, 1, 768]             2,362,368                   1.36%                   --                        --
│    │    │    └─LayerNorm: 4-95              [321, 1, 768]             [321, 1, 768]             1,536                       0.00%                   --                        493,056
│    │    │    └─Sequential: 4-96             [321, 1, 768]             [321, 1, 768]             --                             --                   --                        --
│    │    │    │    └─Linear: 5-70            [321, 1, 768]             [321, 1, 3072]            2,362,368                   1.36%                   --                        758,320,128
│    │    │    │    └─GELU: 5-71              [321, 1, 3072]            [321, 1, 3072]            --                             --                   --                        --
│    │    │    │    └─Linear: 5-72            [321, 1, 3072]            [321, 1, 768]             2,360,064                   1.36%                   --                        757,580,544
│    └─LayerNorm: 2-10                        [1, 256, 768]             [1, 256, 768]             1,536                       0.00%                   --                        1,536
│    └─Sequential: 2-11                       [1, 768, 16, 16]          [1, 1024, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-25                      [1, 768, 16, 16]          [1, 1536, 16, 16]         1,181,184                   0.68%                   [1, 1]                    302,383,104
│    │    └─Tanh: 3-26                        [1, 1536, 16, 16]         [1, 1536, 16, 16]         --                             --                   --                        --
│    │    └─Conv2d: 3-27                      [1, 1536, 16, 16]         [1, 1024, 16, 16]         1,573,888                   0.90%                   [1, 1]                    402,915,328
│    └─Identity: 2-12                         [1, 1024, 16, 16]         [1, 1024, 16, 16]         --                             --                   --                        --
===================================================================================================================================================================================================
Total params: 174,073,612
Trainable params: 174,073,612
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 37.27
===================================================================================================================================================================================================
Input size (MB): 0.79
Forward/backward pass size (MB): 344.47
Params size (MB): 467.33
Estimated Total Size (MB): 812.58
===================================================================================================================================================================================================
Arguments: ()
[32m[09/01 21:08:17 TiTok]: [39mCreating evaluator.
Training!:   0%|                                                                                                                                             | 0/38555 [00:00<?, ?it/s]
[32m[09/01 21:08:17 TiTok]: [39mPreparing model, optimizer and dataloaders
[32m[09/01 21:08:17 TiTok]: [39m***** Running training *****
[32m[09/01 21:08:17 TiTok]: [39m  Num training steps = 500000
[32m[09/01 21:08:17 TiTok]: [39m  Gradient Accumulation steps = 1
[32m[09/01 21:08:17 TiTok]: [39mmixed precision = fp16
[32m[09/01 21:08:17 TiTok]: [39m  Total train batch size (w. parallel, distributed & accumulation) = 64
[32m[09/01 21:08:17 TiTok]: [39maccelerator device: cuda
[32m[09/01 21:08:17 TiTok]: [39mAll globbed checkpoints are: []
[32m[09/01 21:08:17 TiTok]: [39mTraining from scratch.




























Training!:   0%|▏                                                                                                                                | 49/38555 [01:41<12:07:16,  1.13s/it]




























Training!:   0%|▎                                                                                                                                | 99/38555 [02:38<12:03:22,  1.13s/it]





























Training!:   0%|▍                                                                                                                               | 150/38555 [03:36<12:21:00,  1.16s/it]




























Training!:   1%|▋                                                                                                                               | 199/38555 [04:32<12:06:51,  1.14s/it]



























Training!:   1%|▊                                                                                                                               | 247/38555 [05:26<12:14:57,  1.15s/it]Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x0000019253109C60>
Traceback (most recent call last):
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\data\dataloader.py", line 1479, in __del__
    self._shutdown_workers()
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\data\dataloader.py", line 1443, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 149, in join
    res = self._popen.wait(timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\popen_spawn_win32.py", line 110, in wait
    res = _winapi.WaitForSingleObject(int(self._handle), msecs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt:
Training!:   1%|▊                                                                                                                               | 247/38555 [05:28<14:08:41,  1.33s/it]
Traceback (most recent call last):
  File "E:\SLT_FYP\1d-tokenizer\scripts\train_titok.py", line 181, in <module>
    main()
  File "E:\SLT_FYP\1d-tokenizer\scripts\train_titok.py", line 142, in main
    global_step = train_one_epoch(config, logger, accelerator,
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\SLT_FYP\1d-tokenizer\utils\train_utils.py", line 360, in train_one_epoch
    optimizer.step()
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\accelerate\optimizer.py", line 157, in step
    self.scaler.step(self.optimizer, closure)
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\amp\grad_scaler.py", line 453, in step
    retval = self._maybe_opt_step(optimizer, optimizer_state, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\amp\grad_scaler.py", line 350, in _maybe_opt_step
    if not sum(v.item() for v in optimizer_state["found_inf_per_device"].values()):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\amp\grad_scaler.py", line 350, in <genexpr>
    if not sum(v.item() for v in optimizer_state["found_inf_per_device"].values()):
               ^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python311\Lib\site-packages\torch\utils\_device.py", line 78, in __torch_function__
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt